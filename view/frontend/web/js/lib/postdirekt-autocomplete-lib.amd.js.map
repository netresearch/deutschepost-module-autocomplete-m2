{"version":3,"file":"postdirekt-autocomplete-lib.amd.js","sources":["../../node_modules/tslib/tslib.es6.js","../../node_modules/postdirekt-autocomplete/src/api/search-subjects.ts","../../node_modules/postdirekt-autocomplete/src/model/adapter/fetch-adapter.ts","../../node_modules/postdirekt-autocomplete/src/model/defaults.ts","../../node_modules/postdirekt-autocomplete/src/model/request/search-request-builder.ts","../../node_modules/postdirekt-autocomplete/src/service/search-service.ts","../../node_modules/postdirekt-autocomplete/src/model/request/select-request-builder.ts","../../node_modules/postdirekt-autocomplete/src/service/select-service.ts","../../node_modules/postdirekt-autocomplete/src/service/service-factory.ts","../../src/model/autocomplete-address-suggestions.ts","../../src/model/autocomplete-dom-address.ts","../../src/model/key-types.ts","../../src/view/list-renderer.ts","../../src/model/autocomplete-handler.ts","../../src/api/address-input-types.ts","../../src/postdirekt-autocomplete-lib.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/**\n * See LICENSE.txt for license details.\n */\n/**\n * Definition of possible search modes\n */\nenum Subject {\n  Buildings = 'buildings',\n  Cities = 'cities',\n  Districts = 'districts',\n  PostalCodes = 'postalcodes',\n  PostalCodesCities = 'postalcodes_cities',\n  PostalCodesCitiesDistricts = 'postalcodes_cities_districts',\n  PostalCodesCitiesDistrictsStreets = 'postalcodes_cities_districts_streets',\n  PostalCodesCitiesStreets = 'postalcodes_cities_streets',\n}\n\nexport { Subject };\n","/**\n * See LICENSE.txt for license details.\n */\nimport {RequestInterface} from \"../../api/request-builder-interface\";\nimport AdapterInterface from \"../adapter-interface\";\n\n/**\n * Adapter implementation utilizing fetch and therefore only working in browser contexts\n */\nexport default class FetchAdapter implements AdapterInterface {\n\n  /**\n   * Perform arbitrary HTTP request\n   *\n   * @param request RequestInterface\n   */\n  public async request(request: RequestInterface) {\n    const response = await fetch(this.mapRequest(request));\n    // the Autocomplete API only responds with json if there is a success state\n    if (response.status >= 200 && response.status < 300) {\n      if (response.headers.get('Content-Type')?.startsWith('application/json')) {\n        return response.json();\n      } else {\n        return response.text();\n      }\n    }\n    if (response.status === 400) {\n      return response.json().then((r) => {\n        throw new Error((response.statusText + ': ' + r.message).trim())\n      });\n    }\n    return response.text().then((t) => {\n      throw new Error((response.statusText + ' ' + t).trim())\n    });\n  }\n\n  /**\n   * Convert SDK request to HTTP request\n   *\n   * @param request RequestInterface\n   */\n  private mapRequest(request: RequestInterface): Request {\n    return new Request(request.url, {\n      method: request.method,\n      headers: request.headers\n    });\n  }\n}\n","/**\n * See LICENSE.txt for license details.\n */\nimport AdapterInterface from \"../model/adapter-interface\";\nimport FetchAdapter from \"./adapter/fetch-adapter\";\n\n/**\n * Static class for providing global defaults\n */\nexport default class DefaultSettings {\n  public static readonly baseUrl: string = 'https://autocomplete2.postdirekt.de/autocomplete2/';\n  public static readonly headers: object = {\n    Accept: \"application/json\",\n    Authorization: '',\n  };\n\n  /**\n   * Get suitable adapter for current environment\n   */\n  public static getAdapter(): AdapterInterface {\n    /**\n     * @TODO later we want to dynamically check if the environment is node or browser\n     */\n    return new FetchAdapter();\n  }\n}\n","/**\n * See LICENSE.txt for license details.\n */\nimport RequestBuilderInterface, {\n    QueryParams,\n    RequestInterface,\n    SearchOptions\n} from '../../api/request-builder-interface';\nimport {Subject} from '../../api/search-subjects';\nimport DefaultSettings from \"../defaults\";\n\nexport class Request implements RequestInterface {\n    public readonly url: string = '';\n    public readonly method: string = 'GET';\n    public readonly headers: Record<string, string> = {};\n\n    constructor(url: string, method: string = 'GET', headers: Record<string, string> = {}) {\n        this.url = url;\n        this.method = method;\n        this.headers = headers;\n    }\n}\n\n/**\n * Request builder for search request\n */\nexport default class SearchRequestBuilder implements RequestBuilderInterface {\n\n    private readonly baseUrl: string;\n    private readonly accessToken: string;\n\n\n    constructor(baseUrl: string, accessToken: string) {\n        this.baseUrl = baseUrl;\n        this.accessToken = accessToken;\n    }\n\n    /**\n     * Generate a search request with given search options\n     * @param options SearchOptions\n     */\n    create(options: SearchOptions): Request {\n        const {subject, country, ...params} = options;\n        return new Request(\n            this.buildUrl(country, subject, params as QueryParams),\n            'GET',\n            {\n                ...DefaultSettings.headers,\n                ...{\"Authorization\": \"Bearer \" + this.accessToken}\n            }\n        );\n    }\n\n    /**\n     * Generate final url with query parameters\n     *\n     * @param country string\n     * @param subject Subject\n     * @param params QueryParams\n     */\n    private buildUrl(country: string, subject: Subject, params: QueryParams): string {\n        // add country to path\n        let urlString = this.baseUrl + \"/\" + country;\n        // add subject to path\n        urlString = urlString + \"/\" + subject;\n        // add query parameters\n        urlString = urlString + this.buildQueryString(params);\n\n        return urlString;\n    }\n\n    /**\n     * Generate query string from parameter configuration\n     *\n     * @param params QueryParams\n     */\n    private buildQueryString(params: QueryParams): string {\n        let queryString: string = Object.entries(params)\n            .map(([key, val]) => encodeURIComponent(key) + '=' + encodeURIComponent(val))\n            .join('&');\n\n        if (queryString) {\n            queryString = '?' + queryString;\n        }\n\n        return queryString;\n    }\n}\n","/**\n * See LICENSE.txt for license details.\n */\nimport SearchServiceInterface from '../api/search-service-interface';\nimport SearchRequestBuilder from '../model/request/search-request-builder';\nimport SearchResponse from '../model/response/search-response';\nimport AdapterInterface from \"../model/adapter-interface\";\nimport {RequestInterface} from \"../api/request-builder-interface\";\n\n/**\n * Search service for searching address completion suggestions\n */\nexport default class SearchService implements SearchServiceInterface {\n\n  private accessToken: string;\n  private baseUrl: string;\n  private adapter: AdapterInterface;\n\n  readonly requestBuilder: SearchRequestBuilder;\n\n  constructor(\n    accessToken: string,\n    baseUrl: string,\n    adapter: AdapterInterface\n  ) {\n    this.accessToken = accessToken;\n    this.baseUrl = baseUrl;\n    this.adapter = adapter;\n\n    this.requestBuilder = new SearchRequestBuilder(baseUrl, accessToken)\n  }\n\n  /**\n   * Perform a search request\n   *\n   * @param request RequestInterface\n   */\n  public async search(request: RequestInterface): Promise<SearchResponse> {\n    return await this.adapter.request(request) as SearchResponse;\n  }\n}\n","/**\n * See LICENSE.txt for license details.\n */\nimport RequestBuilderInterface, {SelectOptions} from '../../api/request-builder-interface';\nimport SearchRequestBuilder, {Request} from \"./search-request-builder\";\n\nexport {Request};\n\n/**\n * Request builder for select requests\n */\nexport default class SelectRequestBuilder extends SearchRequestBuilder implements RequestBuilderInterface {\n\n  uuid?: string;\n\n  /**\n   * Create a request for selecting a specific suggestion\n   *\n   * @param options SelectOptions\n   */\n  create(options: SelectOptions): Request {\n    return super.create(options);\n  }\n}\n","/**\n * See LICENSE.txt for license details.\n */\nimport SelectRequestBuilder from '../model/request/select-request-builder';\nimport AdapterInterface from \"../model/adapter-interface\";\nimport {RequestInterface} from \"../api/request-builder-interface\";\nimport SelectServiceInterface from \"../api/select-service-interface\";\n\n/**\n * Select service for submitting selection to the API\n */\nexport default class SelectService implements SelectServiceInterface {\n\n  private accessToken: string;\n  private baseUrl: string;\n  private adapter: AdapterInterface;\n\n  readonly requestBuilder: SelectRequestBuilder;\n\n  constructor(\n    accessToken: string,\n    baseUrl: string,\n    adapter: AdapterInterface\n  ) {\n    this.accessToken = accessToken;\n    this.baseUrl = baseUrl;\n    this.adapter = adapter;\n\n    this.requestBuilder = new SelectRequestBuilder(baseUrl, accessToken)\n  }\n\n  /**\n   * Perform a select request\n   *\n   * @param request RequestInterface\n   */\n  public async select(request: RequestInterface): Promise<void> {\n    return this.adapter.request(request);\n  }\n}\n","/**\n * See LICENSE.txt for license details.\n */\nimport SearchService from \"./search-service\";\nimport SelectService from \"./select-service\";\nimport DefaultSettings from \"../model/defaults\";\nimport ServiceFactoryInterface from \"../api/service-factory-interface\";\nimport SelectServiceInterface from \"../api/select-service-interface\";\nimport SearchServiceInterface from \"../api/search-service-interface\";\n\n/**\n * Factory able to create search and select services\n */\nexport default class ServiceFactory implements ServiceFactoryInterface {\n\n  public static createSearchService(accessToken: string): SearchServiceInterface {\n    return new SearchService(\n      accessToken,\n      DefaultSettings.baseUrl + 'search',\n      DefaultSettings.getAdapter()\n    );\n  }\n\n  public static createSelectService(accessToken: string): SelectServiceInterface {\n    return new SelectService(\n      accessToken,\n      DefaultSettings.baseUrl + 'select',\n      DefaultSettings.getAdapter()\n    );\n  }\n\n  createSearchService(accessToken: string): SearchServiceInterface {\n    return ServiceFactory.createSearchService(accessToken);\n  }\n\n  createSelectService(accessToken: string): SelectServiceInterface {\n    return ServiceFactory.createSelectService(accessToken);\n  }\n}\n","/**\n * See LICENSE.md for license details.\n */\n\nimport AddressData from '../api/address-data';\n\nexport default class AutocompleteAddressSuggestions {\n    /**\n     * Data storage for address suggestions from the Autocomplete API.\n     */\n    public suggestions: AddressData[] = [];\n\n    /**\n     * Returns suggestion item with the given UUID.\n     */\n    public getByUuid(uuid: string): AddressData|null {\n        return this.suggestions.find((item) => item.uuid === uuid) || null;\n    }\n}\n","/**\n * See LICENSE.md for license details.\n */\n\nimport DomAddressData from '../api/dom-address-data';\nimport AddressInputType from '../api/address-input-types';\n\n/**\n * Sync data from and to the DOM address inputs.\n * */\nexport default class AutocompleteDomAddress {\n    private readonly inputMap: Map<AddressInputType, HTMLInputElement>;\n\n    constructor(inputMap: Map<AddressInputType, HTMLInputElement>) {\n        this.inputMap = inputMap;\n    }\n\n    /**\n     * Read current address input values from DOM.\n     */\n    get address(): DomAddressData {\n        const result: DomAddressData = { city: '', postalCode: '', street: '' };\n        /**\n         * Note that type safety is guaranteed by the DomAddressData properties\n         * being constructed from the AddressInputType enum, same with the inputMap keys.\n         * They keys in the following iteration therefore always match\n         */\n        this.inputMap.forEach((input, type) => {\n            result[type] = input.value;\n        });\n\n        return result;\n    }\n\n    /**\n     * Update DOM input values with new address data.\n     */\n    set address(newAddressData: DomAddressData) {\n        /**\n         * Note that type safety is guaranteed by the DomAddressData properties\n         * being constructed from the AddressInputType enum, same with the inputMap keys.\n         * They keys in the following iteration therefore always match\n         */\n        for (const [fieldName, field] of this.inputMap) {\n            field.value = newAddressData[fieldName];\n        }\n    }\n}\n","enum Key {\n    ArrowUp = 'ArrowUp',\n    ArrowDown = 'ArrowDown',\n    Enter = 'Enter',\n    Tab = 'Tab',\n}\nexport default Key;\n","/**\n * See LICENSE.md for license details.\n */\nimport AddressSuggestionOption from '../api/address-suggestion-option';\nimport AddressData from '../api/address-data';\nimport Key from '../model/key-types';\n\nexport default class ListRenderer {\n    private removableEventHandler?: ((e: KeyboardEvent) => void);\n\n    private currentField?: HTMLInputElement;\n\n    /**\n     * Attach a given list of suggestions to the given DOM input element,\n     * emulating a datalist element.\n     *\n     * Only one list can be rendered at a time.\n     */\n    public render(inputElement: HTMLInputElement, addressSuggestions: AddressData[]): void {\n        if (!inputElement.parentElement) {\n            throw Error('Input elements without a parent cannot be assigned a suggestion list.');\n        }\n\n        this.remove();\n\n        this.currentField = inputElement;\n\n        /** Disable native autocomplete to avoid overlapping suggestions. */\n        inputElement.setAttribute('autocomplete', 'off');\n\n        const dataList = document.createElement('ul');\n        dataList.setAttribute('id', `datalist-${inputElement.id}`);\n        dataList.setAttribute('class', 'datalist');\n        dataList.setAttribute('style', `width:${inputElement.offsetWidth}px; top:${inputElement.offsetHeight}px;`);\n\n        // Convert address data into AddressSuggestionOptions\n        addressSuggestions.map((addressData: AddressData) => (\n            {\n                id: addressData.uuid,\n                title: [addressData.street, addressData.postalCode, addressData.city].filter(Boolean).join(', '),\n            }\n        ))\n            // Create HTML list of AddressSuggestionOptions\n            .forEach((option: AddressSuggestionOption) => {\n                const li = document.createElement('li');\n                const label = document.createTextNode(option.title);\n\n                li.setAttribute('id', option.id);\n                li.setAttribute('data-value', option.title);\n                li.appendChild(label);\n                dataList.appendChild(li);\n            });\n\n        inputElement.parentElement.appendChild(dataList);\n        inputElement.parentElement.classList.add('autocomplete-container');\n\n        inputElement.setAttribute('list', `datalist-${inputElement.id}`);\n\n        /**\n         * Trigger an item select when a datalist option is clicked.\n         */\n        dataList.addEventListener('mousedown', (e) => {\n            const option = e.target as HTMLElement;\n            this.itemSelect(option);\n            setTimeout(() => inputElement.focus(), 0);\n        });\n\n        /**\n         * Remove the datalist when the field is no longer in focus.\n         */\n        inputElement.addEventListener('focusout', this.remove.bind(this));\n\n        /**\n         * Add listener to observe address field navigation keydowns.\n         */\n        this.removableEventHandler = this.navigationKeyListener.bind(this);\n\n        inputElement.addEventListener('keydown', this.removableEventHandler);\n    }\n\n    /**\n     * Remove the previously rendered list of suggestions.\n     * Removes list from the DOM and detaches all custom event listeners.\n     */\n    public remove(): void {\n        if (!this.removableEventHandler || !this.currentField) {\n            return;\n        }\n\n        const datalist = document.querySelector(`#datalist-${this.currentField.id}`);\n        if (datalist) {\n            datalist.remove();\n        }\n\n        this.currentField.removeEventListener('keydown', this.removableEventHandler);\n\n        this.currentField = undefined;\n    }\n\n    private navigationKeyListener(e: KeyboardEvent): void {\n        if (e.key in Key) {\n            if (e.key !== Key.Tab as string) {\n                e.preventDefault();\n            }\n            this.triggerKeydown(e.key as Key);\n        }\n    }\n\n    private triggerKeydown(key: Key): void {\n        if (!this.currentField) {\n            return;\n        }\n\n        const dataList = document.querySelector(`#datalist-${this.currentField.id}`);\n\n        if (!dataList) {\n            return;\n        }\n\n        const dataOptions: Array<Element> = Array.from(dataList.children);\n        const activeItem: HTMLElement = dataList.querySelector('[data-active]') as HTMLElement;\n        const firstItem = dataOptions.find(() => true) as Element;\n\n        if (!activeItem && key === Key.Enter) {\n            return;\n        }\n\n        if (key === Key.ArrowDown && !activeItem) {\n            firstItem.setAttribute('data-active', 'true');\n        } else if (activeItem) {\n            let prevVisible: HTMLElement | null = null;\n            let nextVisible: HTMLElement | null = null;\n\n            dataOptions.forEach((element, index, array) => {\n                if (element as HTMLElement === activeItem) {\n                    prevVisible = array[index - 1] as HTMLElement;\n                    nextVisible = array[index + 1] as HTMLElement;\n                }\n            });\n            activeItem.removeAttribute('data-active');\n\n            if (key === Key.ArrowUp) {\n                if (prevVisible) {\n                    prevVisible = prevVisible as HTMLElement;\n                    prevVisible.setAttribute('data-active', 'true');\n                    if (prevVisible.offsetTop < dataList.scrollTop) {\n                        dataList.scrollTop -= prevVisible.offsetHeight;\n                    }\n                } else {\n                    dataOptions[dataOptions.length - 1].setAttribute('data-active', 'true');\n                }\n            }\n            if (key === Key.ArrowDown) {\n                if (nextVisible) {\n                    nextVisible = nextVisible as HTMLElement;\n                    nextVisible.setAttribute('data-active', 'true');\n                } else {\n                    dataOptions[0].setAttribute('data-active', 'true');\n                }\n            }\n\n            if (key === Key.Tab) {\n                // Focus the current field so the tab command moves the focus to the next input\n                this.currentField.focus();\n            }\n\n            if ([Key.Enter, Key.Tab].includes(key)) {\n                this.itemSelect(activeItem);\n            }\n        }\n    }\n\n    /**\n     * Simulate a datalist element select event.\n     */\n    private itemSelect(item: HTMLElement): void {\n        if (!this.currentField) {\n            return;\n        }\n        this.currentField.dataset.suggestionUuid = item.id;\n        this.currentField.dispatchEvent(new Event('autocomplete:datalist-select'));\n        this.remove();\n    }\n}\n","/**\n * See LICENSE.md for license details.\n */\n\nimport { Subject as SearchSubjects } from 'postdirekt-autocomplete/src/api/search-subjects';\nimport ServiceFactory from 'postdirekt-autocomplete/src/service/service-factory';\nimport SearchServiceInterface from 'postdirekt-autocomplete/src/api/search-service-interface';\nimport SelectServiceInterface from 'postdirekt-autocomplete/src/api/select-service-interface';\nimport SearchResponse, { Address } from 'postdirekt-autocomplete/src/model/response/search-response';\nimport AddressData from '../api/address-data';\nimport AutocompleteAddressSuggestions from './autocomplete-address-suggestions';\nimport AutocompleteDomAddress from './autocomplete-dom-address';\nimport ListRenderer from '../view/list-renderer';\nimport AddressInputType from '../api/address-input-types';\n\nexport default class AddressAutocomplete {\n    private readonly navigationKeyCodes = ['ArrowUp', 'ArrowDown', 'Escape', 'Enter', 'Space', 'Tab'];\n\n    private readonly searchService: SearchServiceInterface;\n\n    private readonly selectService: SelectServiceInterface;\n\n    private readonly inputMap: Map<AddressInputType, HTMLInputElement>;\n\n    private readonly addressSuggestions: AutocompleteAddressSuggestions;\n\n    private readonly domAddress: AutocompleteDomAddress;\n\n    private readonly countrySelect: HTMLInputElement;\n\n    private readonly listRenderer: ListRenderer;\n\n    private readonly deCountryId: string;\n\n    private readonly typingDelay = 500;\n\n    private timeoutId?: number;\n\n    constructor(\n        inputMap: Map<AddressInputType, HTMLInputElement>,\n        countrySelect: HTMLInputElement,\n        deCountryId: string,\n        token: string,\n    ) {\n        this.inputMap = inputMap;\n        this.countrySelect = countrySelect;\n        this.deCountryId = deCountryId;\n        this.searchService = ServiceFactory.createSearchService(token);\n        this.selectService = ServiceFactory.createSelectService(token);\n        this.addressSuggestions = new AutocompleteAddressSuggestions();\n        this.domAddress = new AutocompleteDomAddress(this.inputMap);\n        this.listRenderer = new ListRenderer();\n    }\n\n    /**\n     * Initialize event listeners on the given address DOM inputs elements.\n     */\n    public start(): void {\n        for (const [type, fieldItem] of this.inputMap) {\n            // Attach event listeners\n            fieldItem.addEventListener('keyup', this.handleFieldKeystroke.bind(this));\n            fieldItem.addEventListener('autocomplete:datalist-select', this.handleDatalistSelect.bind(this));\n        }\n        this.countrySelect.addEventListener('change', this.handleCountryChange.bind(this));\n    }\n\n    /**\n     * Handles keystrokes, but does not react to navigation keys.\n     */\n    public handleFieldKeystroke(e: KeyboardEvent): void {\n        if (this.countrySelect.value !== this.deCountryId) {\n            return;\n        }\n\n        if (!this.navigationKeyCodes.includes(e.code)) {\n            this.triggerDelayedCallback(\n                () => this.searchAction(e.target as HTMLInputElement),\n                this.typingDelay,\n            );\n        }\n    }\n\n    /**\n     * Update the DOM input values with the selected address suggestion\n     * and perform an API select request.\n     */\n    public handleDatalistSelect(e: Event): void {\n        const field = e.target as HTMLInputElement,\n              uuid = field.dataset.suggestionUuid as string,\n              suggestedAddress = this.addressSuggestions.getByUuid(uuid);\n\n        if (!suggestedAddress) {\n            return;\n        }\n\n        this.domAddress.address = suggestedAddress;\n\n        this.selectAction(suggestedAddress.uuid);\n    }\n\n    /**\n     * Remove any existing suggestion list from the DOM if the country is changed away from germany.\n     */\n    public handleCountryChange(): void {\n        if (this.countrySelect.value !== this.deCountryId) {\n            this.listRenderer.remove();\n        }\n    }\n\n    /**\n     * Trigger a given callback with the given delay.\n     * If called multiple times, queued callbacks are discarded.\n     */\n    private triggerDelayedCallback(callback: () => void, delay: number): void {\n        // Clear timeout to prevent previous task from execution\n        if (typeof this.timeoutId !== undefined) {\n            clearTimeout(this.timeoutId);\n        }\n\n        this.timeoutId = window.setTimeout(\n            callback,\n            delay,\n        );\n    }\n\n    /**\n     * Execute a search request at the Autocomplete API,\n     * update the AddressSuggestions model,\n     * and render a suggestion list in the DOM.\n     */\n    private searchAction(currentField: HTMLInputElement): void {\n        const addressData = this.domAddress.address;\n        const subject: SearchSubjects = addressData.street\n            ? SearchSubjects.PostalCodesCitiesStreets\n            : SearchSubjects.PostalCodesCities;\n\n        this.searchService.search(\n            this.searchService.requestBuilder.create(\n                {\n                    country: 'de',\n                    subject,\n                    combined: Object.values(addressData).join(' '),\n                },\n            ),\n        ).then((response: SearchResponse) => {\n            // Map search service response into AddressData array\n            // and store them in suggestions model\n            this.addressSuggestions.suggestions = response.addresses.reduce(\n                (filtered: AddressData[], address: Address) => {\n                    // ignore all results with no uuid.\n                    if (!address.uuid) {\n                        return filtered;\n                    }\n                    filtered.push({\n                        street: address.street || '',\n                        postalCode: address.postalCode || '',\n                        city: address.city || '',\n                        uuid: address.uuid,\n                        district: address.district,\n                    });\n                    return filtered;\n                },\n                [],\n            );\n\n            /* Only render anything if the input is still active. */\n            if (currentField === document.activeElement) {\n                this.listRenderer.render(\n                    currentField,\n                    this.addressSuggestions.suggestions,\n                );\n            }\n        });\n    }\n\n    /**\n     * Executes a select request at the Autocomplete API.\n     */\n    private selectAction(uuid: string): void {\n        this.selectService.select(\n            this.selectService.requestBuilder.create(\n                {\n                    country: 'de',\n                    subject: SearchSubjects.PostalCodesCitiesStreets,\n                    uuid,\n                },\n            ),\n        );\n    }\n}\n","/**\n * See LICENSE.txt for license details.\n */\n\n/**\n * The possible semantic types of inputs the library supports\n */\nenum AddressInputType {\n    City = 'city',\n    Street = 'street',\n    PostalCode = 'postalCode',\n}\n\nexport default AddressInputType;\n","/**\n * See LICENSE.txt for license details.\n */\nimport AddressAutocomplete from './model/autocomplete-handler';\nimport AddressInputType from './api/address-input-types';\n\nconst init = (\n    streetInput: HTMLInputElement,\n    cityInput: HTMLInputElement,\n    postalCodeInput: HTMLInputElement,\n    countryInput: HTMLInputElement,\n    deCountryId: string,\n    token: string,\n): AddressAutocomplete => {\n    const autocomplete = new AddressAutocomplete(\n        new Map([\n            [AddressInputType.Street, streetInput],\n            [AddressInputType.PostalCode, postalCodeInput],\n            [AddressInputType.City, cityInput],\n        ]),\n        countryInput,\n        deCountryId,\n        token\n    );\n\n    autocomplete.start();\n\n    return autocomplete;\n};\n\nexport default { init };\n"],"names":["Request","Key","SearchSubjects","AddressInputType"],"mappings":"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"}